# Introduction

## Commencing Investigation

This economic report has been produced pursuant to a Board investigation under Section 27 of the Act ([Policy Manual](https://www.ptboard.bc.ca/policy-manual)). The Board investigation was commenced on ([DATE to be inserted]), with respect to application #([Application number to be inserted]).

The Board’s letter of instruction to Senior Economist included the application details, outlined below, along with a request for economic analysis pertaining to the following relevant indicators:
[The indicators listed below should be reviewed and updated as required to reflect the specific scope and needs of the application.]

|                                                  |     |
|--------------------------------------------------|-----|
| Trip Volume:                                     | ✓   |
| Trip Revenue:                                    | ✓   |
| Number of Wheelchair Accessible Vehicles (WAVs): | ✓   |
| Number of Active Vehicles per 1,000 Persons:     | ✓   |
| Fare per 5-Kilometre:                            | ✓   |
| Wait Time:                                       | ✓   |
| Concentration indices:                           | ✓   |
| Revenue per Active Vehicle:                      | ✓   |
| Taxi Fleet Utilization Rate:                     | ✓   |
| Vehicle Occupancy Rate:                          | ✓   |
| Driver hourly revenue:                           | ✓   |

## Application Details

This report was produced for the Board regarding a new application for a taxi licence.

The applicant is **[Applicant Legal Name]**, which is doing business as MS Taxi. The application summary states the following:

[This section is provided as a template and should be reviewed and revised as necessary to reflect the specific details of the application.]
There is a need for an additional taxi company servicing West Vancouver, North Vancouver, Vancouver, and YVR. It will positively affect transportation services. As MS Taxi, we will attract new taxi users that will increase the trip volume of all existing and new companies.

Additional details of the application include:

-   Proposed operating area: West Vancouver, North Vancouver, Vancouver, YVR
-   Proposed fleet size: 30 (25 Conventional; 5 WAV)

## Area of Study

The proposed operating area for this taxi application is mainly within the City of Vancouver[Municipality A], District of West Vancouver[Municipality B], and District of North Vancouver[Municipality C]. These municipalities are located in the Greater Vancouver Regional District[Regional District Name].

For the purpose of statistical analysis, both taxi and TNS applications are associated with the same Region, as contemplated in the Board’s operating areas policy in the ([Policy Manual](https://www.ptboard.bc.ca/policy-manual)), even though taxi businesses do not generally operate at a regional level.

For taxi applicants, the Region is determined based on where the existing or proposed operating area is located. In this case, **this taxi application is located in Region 1[Regional District number]**. The Regional District is also determined based on where the existing or proposed operating area is located.

## Existing Licensees

The Board maintains a database of taxi and TNS licensees approved by the Board and key terms and conditions set by the Board, such as fleets, operating areas, and rates. On a regular basis, this is cross-referenced against a list of active licensees provided by the Registrar of Passenger Transportation (Registrar) at the Ministry of Transportation and Transit (MoTT). The Board refers to this database as the “single source of licensee data” or **SSOLD**. Based on the SSOLD, last updated on **September 30, 2024[Date to be inserted]**, the following relevant information can be observed about the existing licensees in the area:

-   At the municipal level,
    -   Number of taxi licensees operating: `r municipal_licensees`
    -   Combined Board-approved maximum fleet size: `r municipal_fleet`
-   At the Regional District level,
    -   Number of taxi licensees operating: `r regional_rd_licensees`
    -   Combined Board-approved maximum fleet size: `r regional_rd_fleet`
-   At the Region level,
    -   Number of taxi licensees operating: `r region_licensees`
    -   Combined Board-approved maximum fleet size: `r region_fleet`

# Background

## Section 28 Criteria

Under Section 28(1) of the Act, the Board must consider the following factors when determining applications:

-   Whether the applicant is fit, proper, and capable of providing the service applied for (threshold test); 
-   Whether there is a public need for the service; and 
-   Whether the application would promote sound economic conditions in the B.C. passenger transportation business.

This economic report provides the Board with data analysis pertaining only to the “public need” (PN) and “sound economic conditions” (SEC) criteria. It does not speak to the fit, proper, and capable criteria.

## PN and SEC Factors

The Board’s ([Policy Manual](https://www.ptboard.bc.ca/policy-manual)) provides information on the factors the Board may consider when determining PN and SEC. This economic report will focus on the underlying PN and SEC factors for the Board’s consideration in determining whether PN and SEC exist. For clarity, this economic report does not determine whether PN and SEC exist.

Under the public need policy in the ([Policy Manual](https://www.ptboard.bc.ca/policy-manual)), PN is divided into the following factors:

-   Demand
-   Accessibility
-   Affordability
-   Safety
-   Service Quality

Under the sound economic conditions policy in the ([Policy Manual](https://www.ptboard.bc.ca/policy-manual)), SEC is divided into the following factors:

-   Sustainability
-   Competition
-   Innovation
-   Variety

This economic report examines key indicators of the taxi and TNS sectors in B.C. Each indicator is identified with a primary PN or SEC factor, as indicated in the following chart:

\newpage
```{r}
library(dplyr)
library(tidyr)
library(flextable)
library(officer)


make_mapping_table <- function() {

  # ---- column structure (like your screenshot) ----
  cols_pn  <- c("Demand", "Quality", "Affordability", "Accessibility")
  cols_sec <- c("Sustainability", "Competition", "Innovation", "Variety")
  all_cols <- c(cols_pn, cols_sec)

  # ---- rows (include section headers as separate rows) ----
  df <- tibble::tibble(
    Factor = c(
      "Demand Factor",
      "Trip Volume",
      "Trip Revenue",
      "Service Quality Factor",
      "Wait Time",
      "Affordability Factor",
      "Fare per 5-Kilometre",
      "Accessibility Factor",
      "Number of Wheelchair Accessible Vehicles (WAVs)",
      "Number of Accessible Trips(WAVs)",
      "Number of Active Vehicles per 1000 Persons",
      "Sustainability Factor",
      "Revenue Per Vehicle",
      "Taxi Fleet Utilization Rate",
      "Vehicle Occupancy Rate",
      "Driver Hourly Revenue"
    )
  ) %>%
    bind_cols(as_tibble(setNames(replicate(length(all_cols), "", simplify = FALSE), all_cols)))

  # ---- put X marks (edit these to match your mapping) ----
  put_x <- function(row_label, col_name) {
    df[df$Factor == row_label, col_name] <<- "X"
  }

  # Demand factor
  put_x("Trip Volume",  "Demand")
  put_x("Trip Revenue", "Demand")

  # Service quality
  put_x("Wait Time", "Quality")

  # Affordability
  put_x("Fare per 5-Kilometre", "Affordability")

  # Accessibility
  put_x("Number of Wheelchair Accessible Vehicles (WAVs)", "Accessibility")
  put_x("Number of Accessible Trips(WAVs)", "Accessibility")  
  put_x("Number of Active Vehicles per 1000 Persons",       "Accessibility")

  # Sustainability (SEC)
  put_x("Revenue Per Vehicle",                   "Sustainability")
  put_x("Taxi Fleet Utilization Rate",           "Sustainability")
  put_x("Vehicle Occupancy Rate",           "Sustainability")
  put_x("Driver Hourly Revenue",           "Sustainability")
  

  # ---- build flextable ----
  ft <- flextable(df)

  # Top spanner row: PN vs SEC
  ft <- add_header_row(
    ft,
    values    = c("", "Public Need (PN)", "Sound Economic Conditions (SEC)"),
    colwidths = c(1, length(cols_pn), length(cols_sec))
  )

  # Style header
  ft <- bold(ft, part = "header")
  ft <- align(ft, align = "center", part = "header")
  ft <- align(ft, j = 1, align = "left", part = "body")

  # Set widths (tune as you like)
  ft <- width(ft, j = 1, width = 3.2)
  ft <- width(ft, j = 2:ncol(df), width = 1.05)

  # Horizontal rules similar to screenshot
  ft <- hline_top(ft, border = fp_border(width = 2), part = "header")
  ft <- hline(ft, border = fp_border(width = 1), part = "header")

  # Bottom rule
  ft <- hline_bottom(ft, border = fp_border(width = 2), part = "body")

  # Vertical divider between PN and SEC (after last PN column)
  pn_last_col <- 1 + length(cols_pn)  # because first column is Factor
  ft <- vline(ft, j = pn_last_col, border = fp_border(width = 1))

  # Make section header rows bold and add separating lines
  section_rows <- which(df$Factor %in% c(
    "Demand Factor",
    "Service Quality Factor",
    "Affordability Factor",
    "Accessibility Factor",
    "Sustainability Factor",
    "Competition Factor"
  ))

  ft <- bold(ft, i = section_rows, j = 1, part = "body")
  for (i in section_rows) {
    ft <- hline(ft, i = i, border = fp_border(width = 1))
  }

# ---- Clean + fit ----
ft <- fontsize(ft, part = "all", size = 5)
ft <- padding(ft, part = "all", padding = 2)

# very important
ft <- set_table_properties(ft, layout = "fixed", width = 1)

n_cols <- ncol(df)

# first column (long text)
ft <- width(ft, j = 1, width = 2.0)

# indicator columns (tight)
ft <- width(ft, j = 2:n_cols, width = 0.55)

# vertical alignment cleaner
ft <- valign(ft, part = "all", valign = "top")



  ft
}

# usage:
mapping_ft <- make_mapping_table()
mapping_ft
```

Please note that this economic report does not provide an analysis of the “innovation” or “variety” factors under SEC.

## Report Constraints

Under Section 28(5) of the Act and the terms and conditions of licence, special authorization licences, including taxi and TNS, are required to submit trip data. The Board has established data requirements outlining the type of trip data that must be submitted. Trip data is submitted by licensees to the Registrar through the Vehicle Safety BC Portal (the Trip Database), also known as the “data warehouse”.

Since only the taxi and TNS sectors are required to report trip data under the data requirements, these are the only sectors eligible for an economic report at this time.

Due to data limitations, only two[Number to be inserted] regions will be analyzed:

-   Region 1 – Lower Mainland including Whistler; and,
-   Region 2 – Capital Regional District (CRD).
-   Region 3 – Vancouver Island excluding CRD [To be specified, if applicable]
-   Region 4 – Interior                       [To be specified, if applicable]
-   Region 5 – Northern B.C. and other        [To be specified, if applicable]

**Regional Districts within these Regions may be analyzed so long as there is adequate data reliability for those Regional Districts.**

At this time, three other regions will not be included in this economic report due to insufficient data coverage, poor data quality, or unreliable trip data submissions: Region 3 (Vancouver Island excluding CRD); Region 4 (Interior); and, Region 5 (Northern B.C. and other).

## Qualifications

This economic report was authored by the Board’s Senior Economist, **Peter Tseng**, who is ultimately responsible for the analysis contained in this report.

Peter Tseng has over a decade of experience in economic analytics, policy evaluation, and statistical reporting. He holds a Ph.D. in Economics from the University of Victoria and has held senior roles with the BC Public Service, including at the Ministry of Finance and Ministry of Health.

# Factors and Their Indicators

All analyses in this report are based on data from the Trip Database unless otherwise specified. Technical details of each indicator can be found in Appendix 1.